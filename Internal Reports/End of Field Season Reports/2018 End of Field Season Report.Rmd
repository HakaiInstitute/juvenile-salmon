---
title: "2018 End of Season Report"
author: "Sara Tremblay-Boyer"
date: "9 ao√ªt 2018"
output: github_document
---

```{r setup, include=FALSE}

library(lubridate)
library(tidyverse)
library(googlesheets)
library(here)
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
```

#Loading data: 

```{r import data}
field_data_workbook_2018 <- gs_key("1iRQCKMTznHbMeI9GunbsgPyb-rtWgwj-0IfxLw7NBJE", 
                                   lookup = F, visibility = "private")

surveys <- gs_read(field_data_workbook_2018, ws = "survey_data")
seines <- gs_read(field_data_workbook_2018, ws = "seine_data")
survey_seines_2018 <- full_join(surveys, seines, by = "survey_id")
write_csv(survey_seines_2018, here("Internal Reports", "End of Field Season Reports", "Raw Data", "survey_seines_2018.csv"))
survey_seines_2018 <- read_csv(here("Internal Reports", "End of Field Season Reports", "Raw Data", "survey_seines_2018.csv"))
  
packages_2018 <- gs_read(field_data_workbook_2018, ws = "package_data")
write_csv(packages_2018, here("Internal Reports", "End of Field Season Reports", "Raw Data", "packages.csv"))
packages_2018 <- read_csv(here("Internal Reports", "End of Field Season Reports", "Raw Data", "packages.csv"))

fish_2018 <- gs_read(field_data_workbook_2018, ws = "fish_and_sealice_field_data")
fish_2018 <- fish_2018[c(1:9,37)]
write_csv(fish_2018, here("Internal Reports", "End of Field Season Reports", "Raw Data", "fish_2018.csv"))
fish_2018 <- read_csv(here("Internal Reports", "End of Field Season Reports", "Raw Data", "fish_2018.csv"))

sealice_field_2018 <- gs_read(field_data_workbook_2018, ws = "fish_and_sealice_field_data")
sealice_field_2018 <- sealice_field_2018[c(1:3,10:34,37)]
write_csv(sealice_field_2018, here("Internal Reports", "End of Field Season Reports", "Raw Data", "sealice_field_2018.csv"))
sealice_field_2018 <- read_csv(here("Internal Reports", "End of Field Season Reports", "Raw Data", "sealice_field_2018.csv"))

```

# Catch Statistics: 
```{r}
field_2018_sites_spp_summary <- survey_seines_2018 %>%
  select(survey_date, site_id, so_taken, pi_taken, cu_taken, co_taken, he_taken, ck_taken, region, zone) %>%
   rename(chinook = ck_taken,
         coho = co_taken,
         chum = cu_taken,
         herring = he_taken,
         pink = pi_taken,
         sockeye = so_taken) %>% 
  gather(sockeye, pink, chum, coho, chinook, herring, key = "species", value = "n") %>% 
  replace_na(list( n = 0)) 

species_summary <- field_2018_sites_spp_summary %>%
  group_by(species) %>% 
  summarize(n = sum(n)) %>% 
  rename(total = n) %>% 
  arrange(desc(total))

kable( species_summary, type = "markdown")

```

