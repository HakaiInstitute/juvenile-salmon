---
title: "Fine Scale Migration Dynamics"
author: "Brett Johnson"
date: "February 5, 2018"
output: 
  bookdown::html_document2:
    theme: "sandstone"
    code_folding: hide
    toc: true
    toc_float: true
    toc_depth: 3
---

Draft Title: Fine scale migration dynamics of juvenile salmon

Focus on fine scale spatial distribution of outmigrating sockeye, pink and chum salmon, including:
* Size structure
* Stock composition
* Migration timing?
* Detailed descriptions of net design and operation.  
* Measurement process - make sure that these are aligned!

Data needs:
* DFO lat and longs

Lit Review:

__Gerbrandt, N., Sc, B., & Routledge, R. (2013). Early Marine Distribution of Out-Migrating Juvenile Sockeye Salmon ( Oncorhynchus nerka ). M.Sc. Thesis, Simon Fraser University.__

Most sockeye swim within 2 m of surface
Bigger fish enter more saline water
Systems that enter directly into highly saline waters have higher proportion of 2 year olds.
Populations migrating through systems with no surface freshwater layer actually swam deeper than populations with a fresh surface water layer.
Surface salinity and day of year were significant predictors of fork length
Beamish, R. J., Pearsall, I. a, & Healey, M. C. (2003). A history of the research on the early marine life of Pacific salmon off Canada’s Pacific coast. NPAFC Bulletin, 3(3), 1–40.

__Brodeur, R. D., Myers, K. W., & Helle, J. H. (2003). Research conducted by the United States on the early ocean life history of Pacific salmon. North Pacific Anadromous Fish Commission Bulletin Number 3, (3), 89–131.__

To read:
Straty 1974: Looks like a good one
Farley et al. (1999, 2000a, 2001a, c)
Straty and Jaenicke 1980
Straty 1981

"Historical marking studies indicate some separa-
tion in major stocks of juvenile Bristol Bay sockeye salmon as far seaward as Port Moller (Straty 1974). Differences that may contribute to stock-specific dis- tributions include time of out migration, travel dis- tance from the lake system of origin, age, and size."
  - This is more related to once they reach open ocean. 
  __Farley, E. V, Murphy, J. M., Wing, B. W., Moss, J. H., & Middleton, A. (2005). Distribution , Migration Pathways , and Size of Western Alaska Juvenile Salmon Along the Eastern Bering Sea Shelf. Alaska Fishery Research Bulletin, 11(1), 15–26.__
  
This paper used a GAM with distance from shore, distance from river mouth, and Julian date to understand what was affecting fork length
To read:
Hartt and Dell 1986; 
Isakson et al. 1986; 
Straty 1974

For pink, chum, chinook, and sockeye.
"In general, length of juvenile salmon increased with the distance from freshwater rearing locations (Figures 4a–e; 5a–c). The length of juvenile age-1.0 and -2.0 sockeye salmon increased with distance from river mouth and displayed a bell shaped curve offshore from the southern shoreline of the SBS region, with the largest fish distributed within middle Bristol Bay and the smallest fish along the southern and northern shorelines (Figures 4a and b)."


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, error = FALSE)
library(hakaisalmon)
library(here)
library(tidyverse)
library(ggridges)
library(lubridate)
library(knitr)
library(broom)

# read in dfo data that Chrys Neville provided that I tidied up first in excel
dfo_data <- read_csv(here::here("data","dfo_data.csv"))

dfo_data <- dfo_data %>% 
  add_column(ufn = "ufn", .before = "org")

# create a table of hakai data from the same site that I want to compare to
# dfo.
hakai_okisollo <- survey_seines_fish_stock_id %>% 
  filter(site_id == "D09") %>% 
  select(survey_date, site_id, species, fork_length, weight, stock_1, prob_1,
         ufn) %>% 
  mutate(org = "hakai")

okisollo <- rbind(hakai_okisollo, dfo_data) %>%
  # categorize sampling events into categorical week and recod the categories so
  # that the middle of the week is the label
  mutate(sampling_week = as.numeric((yday(survey_date) + 4) %/% 7)) %>%
  mutate(
  sampling_week = recode_factor(sampling_week,
  `18` = "May 5",
  `19` = "May 12" ,
  `20` = "May 19",
  `21` = "May 26",
  `22` = "June 2",
  `23` = "June 9",
  `24` = "June 16",
  `25` = "June 23",
  `26` = "June 30",
  `27` = "July 6",
  `28` = "July 13"
  )
  ) %>% 
  mutate(k = 10^5*(weight / fork_length ^ 3)) %>% 
  mutate(year = year(survey_date))
```

# GSI 

## Stock Proportions {.tabset}

### Annual proportion
One of the first things I want to do is simply look at the stock ID proportions
across the whole year for both organizations to see very grossly if there are
obvious differences. 

```{r annual gsi, fig.cap= "Genetic stock proportions of all stocks of sockeye captured in 2015 in Okisollo channel"}
gsi_2015_okisollo <- okisollo %>% 
  filter(year == 2015) %>% 
  drop_na(site_id) %>% 
  drop_na(stock_1) %>%
  filter(prob_1 > 0.6) %>% 
  group_by(org, stock_1) %>% 
  summarize(n = n()) %>% 
  mutate(proportion = n / sum(n)) %>% 
  arrange(org) %>% 
  filter(proportion >= 0.04) %>% 
  ungroup()

prop_remaining <- gsi_2015_okisollo  %>% 
  group_by(org) %>% 
  summarize(remaining = 1 - sum(proportion))

dfo_prop_remaining <- as.numeric(prop_remaining[1,2])
hakai_prop_remaining <- as.numeric(prop_remaining[2,2])

gsi_2015_okisollo <- gsi_2015_okisollo %>% 
  add_row(org = "DFO", stock_1 = NA, proportion = dfo_prop_remaining) %>% 
  add_row(org = "hakai", stock_1 = NA, proportion = hakai_prop_remaining)
  
ggplot(gsi_2015_okisollo, aes(x = org, y = proportion, fill = stock_1)) +
  geom_bar(colour="black", stat="identity", position = 'stack') + 
  ggtitle("2015 Genetic Stock Proportions for DFO and Hakai at Okisollo")

ggsave(here::here("figs", "annual_gsi.png"))
rm(prop_remaining)
rm(gsi_2015_okisollo)
```

It becomes clear that DFO caught a greater proportion of chilko (0.370) compared to Hakai (0.165). Also, DFO caught 20 % Stellako while Hakai caught a very low proportion.

### Additional stock ID

Something that is important is to try to increase the sample size of hakai 
fish identified from a few key seines that dfo conducted on the same day.

To do that I calculate the number of fish that are currently compared, and 
identify where we have additional un-dissected fish.


```{r addtional possible stock_ids}
dfo_so <- dfo_data %>% 
  filter(species == "SO")

hakai_so <- left_join(survey_seines_fish_stock_id, package_data) %>% 
  filter(site_id == "D09", species == "SO") %>% 
  select(survey_date, site_id, species, fork_length, weight, stock_1,
         prob_1, ufn, semsp_id, package_id) %>% 
  mutate(org = "hakai")

hakai_same_date <- semi_join(hakai_so, dfo_so, by = "survey_date") %>% 
  filter(is.na(prob_1)) # removes fish that have already been stock ID'd 

# summarize how many fish DFO have stock ID'd per sampling event
dfo_same_date <- semi_join(dfo_so, hakai_same_date, by = "survey_date") %>% 
  filter(prob_1 != "NA") %>% 
  group_by(survey_date) %>% 
  summarize(n = n())

hakai_same_date_summary <- hakai_same_date %>% 
  group_by(survey_date) %>% 
  summarise(n_hakai = n())

dates_worth_comparing <- full_join(dfo_same_date, hakai_same_date_summary, 
                                   by = "survey_date") %>% 
  drop_na(n) %>% 
  mutate(diff = n - n_hakai) %>% 
  filter(diff > 0)

dates_worth_comparing <- as.Date(dates_worth_comparing$survey_date)

additional_2015_hakai_fish <- hakai_same_date %>% 
  filter(survey_date %in% dates_worth_comparing) %>% 
  left_join(package_data, additional_2015_hakai_fish, by = "package_id")

print(additional_2015_hakai_fish)

rm(dfo_same_date, hakai_okisollo, hakai_same_date, dates_worth_comparing, dfo_so, hakai_so, hakai_same_date_summary)
```

Based on the seines that DFO has done stock IDs, there is opportunity to stock ID an additional `r nrow(additional_2015_hakai_fish)` fish from the Hakai collection, although none of these fish have actually been dissected.

If analyzing additional DFO fish is an option, then I should redo the above analysis.

Also I should consider how important it is to compare the proportion of stocks observed by organization on the same date. If I only summarize proportions by the entire sampling season then it is not neccessary.

### Stock Proportions Chi Square Test

I need to develop a method to paramaterize the difference in proportions
of stocks sampled. The simplest way to do this would be to summarize the stock proportions caught over the entire year. However, because we often sampled at different times of the season, ie our temporal distribution is
dissimilar, an integration of stock proportions caught would likely show a difference in proportions caught but would be influenced mainly by the temporal distribution of sampling. Therefore, I want to compare proportions of stocks caught by both groups on the same day in the best case. This is sort of like a repeated measure, except from one week to the next I expect very different stock proportions. I therefore need to do  multiple proportion tests and parameterize the difference of each seine, and then average that parameter from every comparison I make. 

I will try to do this fitst by calculating stock proportion over the whole year, with a chi square test. This should serve as a test case that I expect to show that these fish were sampled from different populations.

First, I need to convert proportions to integers by multiplying them by 100.
```{r proportions test}

# First, test proportion over the whole year
okisollo_2015 <- okisollo %>% 
  filter(year(survey_date) == 2015, species == "SO") %>% 
  mutate(n = round(k * 100, 0)) %>% 
  dplyr::select(org, stock_1, n) %>% 
  drop_na(stock_1) %>% 
  drop_na(n) %>% 
  filter(n > 0)

df <- as.data.frame(okisollo_2015)

df.expanded <- df[rep(row.names(df), df$n), 1:2]

table <- table(df.expanded$org, df.expanded$stock_1)
head(table)

(x2 <- chisq.test(table))


rm(okisollo_2015, x2, df, df.expanded)
# Then, test proportions over each week
#TODO: Figure out if the chi square test is the best way to test this, it may
# be sufficient to plot this by date.
#TODO: Test proportions over each week.
```

According to the chi square test for the entire seasons proportions, the two methods of sampling are not independent. Given that I really didn't expect this result, and given that when I plot the proportions annually it is clear that they are quite different, I'm not sure that a chi square test is the appropriate statistical test to use.

### Stock Proportions by Week

```{r plot proportions by week}

comparable_dates <- c(as_date("2015-06-01"), as_date("2015-06-09"), as_date("2015-06-22"), as_date("2015-06-29"),
                            as_date("2015-07-06"), as_date("2015-07-07"))
okisollo %>% 
  drop_na(site_id) %>% 
  drop_na(stock_1) %>%
  filter(prob_1 > 0.5) %>% 
  filter(survey_date %in% comparable_dates) %>% 
  group_by(org, survey_date, stock_1) %>% 
  summarize(n = n()) %>% 
  mutate(proportion = n / sum(n)) %>% 
  arrange(org) %>% 
  ggplot(aes(x = org, y = proportion, fill = stock_1, label = n)) +
    geom_bar(colour="black", stat="identity", position = 'stack') +
   geom_text(size = 3, position = position_stack(vjust = 0.5)) +
  facet_wrap(~ survey_date) + 
  scale_x_discrete(breaks=c("DFO", "hakai"),
                      labels=c("Deep", "Shallow"))+
  xlab("Habitat") +
  ylab("Proportion")

ggsave(here::here("figs", "gsi_props_by_week.png"))
```

# Lenghts 
## Stellako Lengths {.tabset}

Its interesting that so many Stellako stocks were caught in deeper water by DFO. I propose two questions:

### Are the stellako fish caught by each organization different than each other?

```{r compare stellako fish by org}
stellako_length_dist_by_org <- okisollo %>% 
  filter(year == "2015", stock_1 == "Stellako")

ggplot(stellako_length_dist_by_org, aes(x = survey_date, y = org)) +
  geom_density_ridges() +
  ggtitle("Stellako sockeye temporal sampling distribution by org")

ggplot(stellako_length_dist_by_org, aes(x = fork_length, y = org)) +
  geom_density_ridges() +
  ggtitle("Stellako sockeye fork length frequency distribution by organization")
```

#### 2. Are stellako different than other stocks?

```{r fig.cap= "Stellako from both orgs temporal sampling distribution"}
stellako <- okisollo %>% 
  filter(stock_1 == "Stellako") %>% 
  filter(year == 2015) %>% 
  mutate(stock_group = "stellako")

other <- okisollo %>% 
  filter(year == 2015) %>% 
  filter(stock_1 != "Stellako") %>% 
  mutate(stock_group = "all_others")

stellako <- rbind(stellako, other)

# Demonstrate temporal sampling regime
ggplot(stellako, aes(x = survey_date, y = stock_group)) +
         geom_density_ridges() +
  ggtitle("Stellako (from both orgs) temporal sampling distribution")
```

```{r, fig.cap="Stellako sockeye length distribution"}
# Demonstrate lengthe frequency distribution by stock by week
ggplot(stellako, aes(x = fork_length, y = sampling_week, fill = stock_group)) +
  geom_density_ridges(alpha = 0.5) +
  ggtitle("Stellako sockeye length distribution")
```

```{r, Stellako sockeye length distribution from both organizations compared to all other stocks not including stellako}
# Because the temporal sampling frequency is so different between stellako and other fish, I average lengths by week so that I can do a t-test on a comparable sample

stellako_by_week <- stellako %>% 
  group_by(sampling_week, stock_group) %>% 
  summarize(mean_fl = mean(fork_length, na.rm = TRUE)) 

ggplot(stellako_by_week, aes(x = mean_fl, fill = stock_group)) +
  geom_density(alpha = 0.5) +
  ggtitle("")

stellako_by_week <- stellako %>% 
  group_by(sampling_week, stock_group) %>% 
  summarize(mean_fl = mean(fork_length, na.rm = TRUE)) %>% 
  spread(key = stock_group, value = mean_fl) %>% 
  drop_na("stellako") %>% 
  mutate(diff = stellako - all_others)

ggplot(stellako_by_week, aes(x = sampling_week, y = diff)) +
  geom_point() +
  ggtitle("Diff of stellako lengths and all other stocks")

```

```{r}
stel <- as.numeric(stellako_by_week$stellako)
oth <- as.numeric(stellako_by_week$all_others)

t.test(stel, oth, paired = FALSE)

rm(stellako_by_week)
rm(other)
rm(stellako)
```


```{r averaged by week}

```

TODO: I should look at DFOs Stellako lengths to see if maybe they were catching a higher proportion of
2 year olds.

## Chilko lengths {.tabset}

```{r sampling distributions}
okisollo %>%
  filter(year == 2015)
  ggplot(aes(x = survey_date, y = org)) +
  geom_density_ridges() +
    ggtitle("DFO and Hakai temportal sampling distribution in 2015")

Chilko <- okisollo %>% 
  filter(stock_1 == "Chilko") %>% 
  filter(year == 2015) %>% 
  mutate(stock_group = "Chilko")

other <- okisollo %>% 
  filter(year == 2015) %>% 
  filter(stock_1 != "Chilko") %>% 
  mutate(stock_group = "all_others")

chilko_and_other <- rbind(Chilko, other)

# Plot samplind distribution to see if temporal sampling overlaps sufficiently
# to remove the bias incurred from increasing fork_length over the season. 
ggplot(chilko_and_other, aes(x = survey_date, fill = stock_group)) +
         geom_density(alpha = 0.5) +
  ggtitle("sampling distribution of stock groups")

# Plot length distributions by week
ggplot(chilko_and_other, aes(x = fork_length, y = sampling_week, fill = stock_group)) +
  geom_density_ridges(alpha = 0.5) +
  ggtitle("Chilko Sockeye Length Distribution")

chilko_and_other_annual_dfo <- chilko_and_other %>% 
  # Remove first and last week becayse may 12 doesn't have comparison to chilko, and July 13 was a number of what I think were 1 year old fish that were identified as Lower Adams Sockeye.
  filter(sampling_week != "July 13", sampling_week != "May 12", org == "DFO",  year == 2015) 

t.test(fork_length ~ stock_group, data = chilko_and_other_annual_dfo)

chilko_and_other_annual_hakai <- chilko_and_other %>% 
  # Remove first and last week becayse may 12 doesn't have comparison to chilko, and July 13 was a number of what I think were 1 year old fish that were identified as Lower Adams Sockeye.
  filter(sampling_week != "July 13", sampling_week != "May 12", org == "hakai", year == 2015) 

t.test(fork_length ~ stock_group, data = chilko_and_other_annual_hakai)
```

Looks like there is no significant trend over time in the difference between chilko and other stocks when each habitat is compared separately. 

```{r diff in lengths of chilko compared to all others}
chilko_by_day_dfo <- chilko_and_other %>% 
  filter(org == "DFO") %>% 
  group_by(survey_date, stock_group) %>% 
  summarize(mean = mean(fork_length, na.rm = TRUE)) %>% 
  spread(key = stock_group, value = mean) %>% 
  drop_na("Chilko") %>% 
  mutate(diff = Chilko - all_others)
# I noticed the difference in means of chilko lengths compared to all other
# lengths seemed to increase over the season so I plotted the difference over
# time and it is an intersting trend that I can't explain:
ggplot(chilko_by_day_dfo, aes(x = survey_date, y = diff)) +
    geom_point() +
  geom_smooth(method = lm)+
  ggtitle("Diff in lengths of Chilko vs other stocks from DFO catches")

lm_dfo <- lm(diff ~ survey_date, data = chilko_by_day_dfo)
summary(lm_dfo)

chilko_by_day_hakai <- chilko_and_other %>% 
  filter(org == "hakai") %>% 
  group_by(survey_date, stock_group) %>% 
  summarize(mean = mean(fork_length, na.rm = TRUE)) %>% 
  spread(key = stock_group, value = mean) %>% 
  drop_na("Chilko") %>% 
  mutate(diff = Chilko - all_others)
# I noticed the difference in means of chilko lengths compared to all other
# lengths seemed to increase over the season so I plotted the difference over
# time and it is an intersting trend that I can't explain:
ggplot(chilko_by_day_hakai, aes(x = survey_date, y = diff)) +
    geom_point() +
  geom_smooth(method = lm)+
  ggtitle("Diff in lengths of Chilko vs other stocks from hakai catches")

lm_hakai <- lm(diff ~ survey_date, data = chilko_by_day_hakai)
summary(lm_hakai)
```

There is a significant difference in the lenth of chilko sockeye caught by DFO compared to chilko sockeye caught by hakai. No significant trend in the difference between hakai and dfo sockeye over time.
```{r diff in lengths of chilko between orgs}
chilko_lengths_hakai_dfo <- Chilko %>% 
  group_by(org, sampling_week) %>% 
  summarise(mean_fl = mean(fork_length, na.rm = TRUE)) %>% 
  spread(key = org, value = mean_fl) %>% 
  mutate(diff = DFO - hakai) %>% 
  drop_na() %>% 
  mutate(sampling_week = c(1,2,3,4,5,6,7))

ggplot(chilko_lengths_hakai_dfo, aes(x = sampling_week, y = diff)) +
  geom_point() +
  ggtitle("Diff in lengths of chilko between hakai and dfo")

t.test(fork_length ~ org, data = Chilko)

lm_dfo_hakai_chilko <- lm(diff ~ sampling_week, data = chilko_lengths_hakai_dfo)
summary(lm_dfo_hakai_chilko)
rm(Chilko_by_week)
rm(other)
```

## Species length comparison

Here I compute the average fork length for each species by week and then calculate the difference in average lengths for each week. I then conduct a t-test on the averaged length for each week, for each species.
I do this in an attempt to standardize the sampling over time, because we know fish are growing longer over time, and having unequal temporal sampling distribution would skew the results.
```{r sockeye averaged by week}


all_SO_by_week_by_org <- okisollo %>% 
  filter(year == 2015, species == "SO") %>% 
  group_by(sampling_week, org) %>% 
  summarize(mean = mean(fork_length, na.rm = TRUE)) %>% 
  spread(key = org, value = mean) %>% 
  mutate(diff = DFO - hakai)

# I noticed the difference in means of chilko lengths compared to all other
# lengths seemed to increase over the season so I plotted the difference over
# time and it is an intersting trend that I can't explain.
ggplot(all_SO_by_week_by_org, aes(x = sampling_week, y = diff)) +
    geom_point() 

dfo <- as.numeric(all_SO_by_week_by_org$DFO)
hakai <- as.numeric(all_SO_by_week_by_org$hakai)

(SO_lengths_by_week_t_test <- tidy(t.test(dfo, hakai, paired = TRUE)) %>% 
    mutate(species = "SO"))

okisollo_2015_so_lengths <- okisollo %>% 
  filter(year == "2015") %>% 
  filter(fork_length < 300, species == "SO") 
  
ggplot(okisollo_2015_so_lengths, aes(x = survey_date, y = fork_length, colour = species)) +
  geom_point() +
  geom_smooth(method = lm)+ 
  facet_grid(org~.)
```

```{r pink averaged by week}
all_PI_by_week_by_org <- okisollo %>% 
  filter(year == 2015, species == "PI") %>% 
  filter(fork_length < 480) %>% # There was a dfo pink that was 480 mm caught 
  # which is not the same age class so I filter it out.
  group_by(sampling_week, org) %>% 
  summarize(mean = mean(fork_length, na.rm = TRUE)) %>% 
  spread(key = org, value = mean) %>% 
  mutate(diff = DFO - hakai)

# I noticed the difference in means of chilko lengths compared to all other
# lengths seemed to increase over the season so I plotted the difference over
# time and it is an intersting trend that I can't explain.
ggplot(all_PI_by_week_by_org, aes(x = sampling_week, y = diff)) +
    geom_point() 

dfo <- as.numeric(all_PI_by_week_by_org$DFO)
hakai <- as.numeric(all_PI_by_week_by_org$hakai)


(PI_lengths_by_week_t_test <- tidy(t.test(dfo, hakai, paired = TRUE)) %>% 
    mutate(species = "PI"))

```

```{r chum averaged by week}
all_CU_by_week_by_org <- okisollo %>% 
  filter(year == 2015, species == "CU") %>% 
  group_by(sampling_week, org) %>% 
  summarize(mean = mean(fork_length, na.rm = TRUE)) %>% 
  spread(key = org, value = mean) %>% 
  mutate(diff = DFO - hakai)

# I noticed the difference in means of chilko lengths compared to all other
# lengths seemed to increase over the season so I plotted the difference over
# time and it is an intersting trend that I can't explain.
ggplot(all_CU_by_week_by_org, aes(x = sampling_week, y = diff)) +
    geom_point() 

dfo <- as.numeric(all_CU_by_week_by_org$DFO)
hakai <- as.numeric(all_CU_by_week_by_org$hakai)


(CU_lengths_by_week_t_test <- tidy(t.test(dfo, hakai, paired = TRUE)) %>% 
    mutate(species = "CU"))

length_difference <- rbind(CU_lengths_by_week_t_test, PI_lengths_by_week_t_test,
                           SO_lengths_by_week_t_test)

rm(CU_lengths_by_week_t_test)
rm(PI_lengths_by_week_t_test)
rm(SO_lengths_by_week_t_test)  
rm(dfo)
rm(hakai)
rm(all_CU_by_week_by_org)
rm(all_PI_by_week_by_org)
rm(all_SO_by_week_by_org)
```

When looking at the average difference in length between deep and shallow water of fish for each week we see that chum and sockeye are significantly different between deep and shallow. Pink however, are not significantly different.

### Barplot species lengths annually by region

```{r barplot of all species lengths}
lengths_2015 <- okisollo %>% 
  filter(year == 2015, fork_length < 300, species %in% c("SO", "PI", "CU", "CO")) %>%
  group_by(org, species) %>% 
  summarise(mean = mean(fork_length, na.rm = T),
            sd = sd(fork_length, na.rm = T), 
            n = n()) %>% 
  mutate(CI = 1.96 * (sd/sqrt(n)))

lengths_2015 %>% ggplot(aes(x = species, y = mean, fill = org)) +
    geom_bar(stat = "identity", position = position_dodge()) +
    geom_errorbar(position = position_dodge(.9), width = .25, aes(ymin = mean - CI, ymax = mean +
                        CI)) +
  ylab("Fork Length (mm)") +
  xlab("Species")

ggsave(here::here("figs", "fork_length_barplot.png"))
```

In this barplot I don't average lengths by week to make sure that temporal distribution is comparable. Instead I just plot the average for the whole season.

When simply plotting the length of each species, you can see that deep fish 
were  longer than shallow caught fish. This is just based on the annual average for each species. A potential confounder with this comparison is that the temporal sampling distribution was not equal, and we know that over the length of the season, fish get longer.

It's possible that I need to use a more complicated model to include the variation that is introduced by the time variable.

# Weight 

## Weight averaged annualy by region {.tabset}
Before working with the weight data, I needt to understand the potential bias
in our lab weight measurements by comparing the weights to what was measured in
the field.

## CPUE {.tabset}
It would be interesting to plot cpue for 1 week periods and do a linear regression between Hakai and DFO data to see if we capture migration timing
similarly. 

